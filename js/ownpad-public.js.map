{"version":3,"file":"ownpad-public.js?v=6e5561e88b82f666602c","mappings":"mBAAA,MASGA,EAAI,CAACC,EAAGC,EAAGC,KACZ,MAAMC,EAAIC,OAAOC,OAAO,CACtBC,QAAQ,GACPJ,GAAK,CAAC,GAST,MAAuB,MAAhBF,EAAEO,OAAO,KAAeP,EAAI,IAAMA,GARhCQ,GADoBA,EASqBP,GAAK,CAAC,IARtC,CAAC,EAQ4BD,EARvBS,QACpB,eACA,SAASC,EAAGC,GACV,MAAMC,EAAIJ,EAAEG,GACZ,OAAOR,EAAEG,OAASO,mBAA+B,iBAALD,GAA6B,iBAALA,EAAgBA,EAAEE,WAAaJ,GAAiB,iBAALE,GAA6B,iBAALA,EAAgBA,EAAEE,WAAaJ,CACxK,IANa,IAAYF,CAS6B,EAa5D,SAASO,IACP,IAAIf,EAAIgB,OAAOC,YACf,UAAWjB,EAAI,IAAK,CAClBA,EAAIkB,SAASC,SACb,MAAMlB,EAAID,EAAEoB,QAAQ,eACpB,IAAW,IAAPnB,EACFD,EAAIA,EAAEqB,MAAM,EAAGpB,OACZ,CACH,MAAMC,EAAIF,EAAEoB,QAAQ,IAAK,GACzBpB,EAAIA,EAAEqB,MAAM,EAAGnB,EAAI,EAAIA,OAAI,EAC7B,CACF,CACA,OAAOF,CACT,CC/CA,MAAMsB,EAAeC,SAASC,eAAe,YCAvCC,EAAeF,SAASC,eAAe,YCe7CR,OAAOU,iBAAiB,oBAAoB,WAE3C,GFhBuBJ,GAAuC,MAAvBA,EAAaK,SCAhCF,GAAuC,yBAAvBA,EAAaE,OCiBhD,OAGD,MAAMC,EAAcL,SAASC,eAAe,wBACtCK,EAAmBN,SAASC,eAAe,gBAC3CM,EAAaP,SAASQ,cAAc,kBAAoBR,SAASQ,cAAc,yBAC/EC,EAAcT,SAASQ,cAAc,YAGrCE,EHLA,EAACjC,EAAGC,EAAGC,KACZ,IAAIC,EAAG+B,EAAGC,EACV,MAAM3B,EAAIJ,OAAOC,OAAO,CACtB+B,WAAW,GACVlC,GAAK,CAAC,GAAIQ,EAA4C,OAAvCP,EAAS,MAALD,OAAY,EAASA,EAAEmC,SAAmBlC,EAAIY,IACpE,OAAgI,KAAzC,OAA9EoB,EAAiD,OAA5CD,EAAc,MAAVlB,YAAiB,EAASA,OAAOsB,SAAc,EAASJ,EAAEK,aAAkB,EAASJ,EAAEK,oBAA8BhC,EAAE4B,UAA6B1B,EAAI,aAAeX,EAAEC,EAAGC,EAAGC,GAA5CQ,EAAIX,EAAEC,EAAGC,EAAGC,EAAkC,EGAlLuC,CAAY,8BAA+B,CAAEC,MAD1Cb,EAAiBF,QAIhCgB,EAAapB,SAASqB,cAAc,UAC1CD,EAAWE,MAAMC,OAAS,OAC1BH,EAAWE,MAAME,MAAQ,OACzBJ,EAAWE,MAAMG,SAAW,WAGxBpB,IACHA,EAAYqB,UAAY,GACxBrB,EAAYsB,YAAYP,GACxBA,EAAWQ,IAAMlB,EACjBH,EAAWe,MAAMO,QAAU,OAC3BpB,EAAYa,MAAMQ,UAAY,oCAE9BrB,EAAYa,MAAMS,WAAa,IAC/BtB,EAAYa,MAAMU,YAAc,IAChCvB,EAAYa,MAAME,MAAQ,OAC1Bf,EAAYa,MAAMW,aAAe,QAEnC,G","sources":["webpack:///ownpad/node_modules/@nextcloud/router/dist/index.mjs","webpack:///ownpad/src/utils/isPublicPage.js","webpack:///ownpad/src/utils/isOwnpad.js","webpack:///ownpad/src/public.js"],"sourcesContent":["const R = (n, e) => d(n, \"\", e), g = (n) => \"/remote.php/\" + n, U = (n, e) => {\n  var o;\n  return ((o = e == null ? void 0 : e.baseURL) != null ? o : w()) + g(n);\n}, v = (n, e, o) => {\n  var c;\n  const i = Object.assign({\n    ocsVersion: 2\n  }, o || {}).ocsVersion === 1 ? 1 : 2;\n  return ((c = o == null ? void 0 : o.baseURL) != null ? c : w()) + \"/ocs/v\" + i + \".php\" + u(n, e, o);\n}, u = (n, e, o) => {\n  const c = Object.assign({\n    escape: !0\n  }, o || {}), r = function(i, s) {\n    return s = s || {}, i.replace(\n      /{([^{}]*)}/g,\n      function(l, t) {\n        const a = s[t];\n        return c.escape ? encodeURIComponent(typeof a == \"string\" || typeof a == \"number\" ? a.toString() : l) : typeof a == \"string\" || typeof a == \"number\" ? a.toString() : l;\n      }\n    );\n  };\n  return n.charAt(0) !== \"/\" && (n = \"/\" + n), r(n, e || {});\n}, _ = (n, e, o) => {\n  var c, r, i;\n  const s = Object.assign({\n    noRewrite: !1\n  }, o || {}), l = (c = o == null ? void 0 : o.baseURL) != null ? c : f();\n  return ((i = (r = window == null ? void 0 : window.OC) == null ? void 0 : r.config) == null ? void 0 : i.modRewriteWorking) === !0 && !s.noRewrite ? l + u(n, e, o) : l + \"/index.php\" + u(n, e, o);\n}, h = (n, e) => e.includes(\".\") ? d(n, \"img\", e) : d(n, \"img\", \"\".concat(e, \".svg\")), d = (n, e, o) => {\n  var c, r, i;\n  const s = (i = (r = (c = window == null ? void 0 : window.OC) == null ? void 0 : c.coreApps) == null ? void 0 : r.includes(n)) != null ? i : !1, l = o.slice(-3) === \"php\";\n  let t = f();\n  return l && !s ? (t += \"/index.php/apps/\".concat(n), e && (t += \"/\".concat(encodeURI(e))), o !== \"index.php\" && (t += \"/\".concat(o))) : !l && !s ? (t = b(n), e && (t += \"/\".concat(e, \"/\")), t.at(-1) !== \"/\" && (t += \"/\"), t += o) : ((n === \"settings\" || n === \"core\" || n === \"search\") && e === \"ajax\" && (t += \"/index.php\"), n && (t += \"/\".concat(n)), e && (t += \"/\".concat(e)), t += \"/\".concat(o)), t;\n}, w = () => window.location.protocol + \"//\" + window.location.host + f();\nfunction f() {\n  let n = window._oc_webroot;\n  if (typeof n > \"u\") {\n    n = location.pathname;\n    const e = n.indexOf(\"/index.php/\");\n    if (e !== -1)\n      n = n.slice(0, e);\n    else {\n      const o = n.indexOf(\"/\", 1);\n      n = n.slice(0, o > 0 ? o : void 0);\n    }\n  }\n  return n;\n}\nfunction b(n) {\n  var e, o;\n  return (o = ((e = window._oc_appswebroots) != null ? e : {})[n]) != null ? o : \"\";\n}\nexport {\n  d as generateFilePath,\n  v as generateOcsUrl,\n  U as generateRemoteUrl,\n  _ as generateUrl,\n  b as getAppRootUrl,\n  w as getBaseUrl,\n  f as getRootUrl,\n  h as imagePath,\n  R as linkTo\n};\n","const isPublicElmt = document.getElementById('isPublic')\nexport default () => !!(isPublicElmt && isPublicElmt.value === '1')\n","const mimetypeElmt = document.getElementById('mimetype')\nexport default () => mimetypeElmt && mimetypeElmt.value === 'application/x-ownpad'\n","/**\n * Nextcloud - Ownpad\n *\n * This file is licensed under the Affero General Public License\n * version 3 or later. See the COPYING file.\n *\n * @author Olivier Tétard <olivier.tetard@miskin.fr>\n * @copyright Olivier Tétard <olivier.tetard@miskin.fr>, 2023\n */\n\nimport { generateUrl } from '@nextcloud/router'\n\nimport isPublicPage from './utils/isPublicPage.js'\nimport isOwnpad from './utils/isOwnpad.js'\n\nwindow.addEventListener('DOMContentLoaded', function() {\n\t// If we display a folder, we don't have anything more to do here\n\tif (isPublicPage() && !isOwnpad()) {\n\t\treturn\n\t}\n\n\tconst contentElmt = document.getElementById('files-public-content')\n\tconst sharingTokenElmt = document.getElementById('sharingToken')\n\tconst footerElmt = document.querySelector('body > footer') || document.querySelector('#app-content > footer')\n\tconst mainContent = document.querySelector('#content')\n\n\tconst sharingToken = sharingTokenElmt.value\n\tconst viewerUrl = generateUrl('/apps/ownpad/public/{token}', { token: sharingToken })\n\n\t// Create viewer frame\n\tconst viewerNode = document.createElement('iframe')\n\tviewerNode.style.height = '100%'\n\tviewerNode.style.width = '100%'\n\tviewerNode.style.position = 'absolute'\n\n\t// Inject viewer\n\tif (contentElmt) {\n\t\tcontentElmt.innerHTML = ''\n\t\tcontentElmt.appendChild(viewerNode)\n\t\tviewerNode.src = viewerUrl\n\t\tfooterElmt.style.display = 'none'\n\t\tmainContent.style.minHeight = 'calc(100% - var(--header-height))' // Make the viewer take the whole height as the footer is now hidden.\n\t\t// overwrite style in order to fix the viewer on public pages\n\t\tmainContent.style.marginLeft = '0'\n\t\tmainContent.style.marginRight = '0'\n\t\tmainContent.style.width = '100%'\n\t\tmainContent.style.borderRadius = 'unset'\n\t}\n})\n"],"names":["u","n","e","o","c","Object","assign","escape","charAt","s","replace","l","t","a","encodeURIComponent","toString","f","window","_oc_webroot","location","pathname","indexOf","slice","isPublicElmt","document","getElementById","mimetypeElmt","addEventListener","value","contentElmt","sharingTokenElmt","footerElmt","querySelector","mainContent","viewerUrl","r","i","noRewrite","baseURL","OC","config","modRewriteWorking","generateUrl","token","viewerNode","createElement","style","height","width","position","innerHTML","appendChild","src","display","minHeight","marginLeft","marginRight","borderRadius"],"sourceRoot":""}